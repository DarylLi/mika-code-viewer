{"version":3,"file":"bundle.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\n/**\r\n *\r\n * ## renderFrameDom主渲染函数\r\n * @param {source} source\r\n * @param {option} options\r\n */\r\nconst renderFrameDom = async (source, options) => {\r\n  const { resourceLink, assetList, cdnLinks } = source;\r\n  let html = \"\",\r\n    css = \"\",\r\n    javascript = \"\";\r\n  async function getLinks() {\r\n    Promise.all([\r\n      await axios(`${resourceLink}/index.html`).then((res) => {\r\n        html = res.data;\r\n        return res;\r\n      }),\r\n      await axios(`${resourceLink}/index.js`).then((res) => {\r\n        javascript = res.data;\r\n        return res;\r\n      }),\r\n      await axios(`${resourceLink}/index.css`).then((res) => {\r\n        css = res.data;\r\n        return res;\r\n      }),\r\n    ])\r\n      .then((res) => {\r\n        console.log(res);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n  await getLinks();\r\n  // source of run code array\r\n  let runCdnList = [];\r\n  // get sources from link method\r\n  async function* requestListMaps() {\r\n    if (cdnLinks.length === 0) return;\r\n    let index = 0;\r\n    const requestMapList = cdnLinks.map(\r\n      (link) => () =>\r\n        new Promise(async (res, rej) => {\r\n          try {\r\n            res(await axios(link));\r\n          } catch (err) {\r\n            console.log(err);\r\n            // if request to codepen soure error, relink to local file\r\n            try {\r\n              res(\r\n                await axios(\r\n                  `${resourceLink}/${\r\n                    link.split(\"/\")[link.split(\"/\").length - 1]\r\n                  }`\r\n                )\r\n              );\r\n            } catch (othererr) {\r\n              console.log(othererr);\r\n              res(\"\");\r\n            }\r\n          }\r\n        })\r\n    );\r\n    try {\r\n      while (true) {\r\n        const res = await requestMapList[index]();\r\n        yield res;\r\n        if (index === requestMapList.length - 1) {\r\n          return;\r\n        }\r\n        index++;\r\n      }\r\n    } finally {\r\n    }\r\n  }\r\n  // request and get source from link\r\n  const getLinkStart = async () => {\r\n    for await (const result of requestListMaps()) {\r\n      runCdnList.push(result?.data);\r\n    }\r\n    return \"done\";\r\n  };\r\n  // await getLinkStart();\r\n  // replace souce link from codepen.io\r\n  let styleCode =\r\n    `body::-webkit-scrollbar {width: 6px;height: 6px;background: #fff000}body::-webkit-scrollbar-track {box-shadow: inset 0 0 0px rgba(240, 240, 240, .5);border-radius: 10px;background: #fff;}body::-webkit-scrollbar-thumb {border-radius: 10px;box-shadow: inset 0 0 0px rgba(118, 118, 118, 0.5);background-color: #6a5f54;}html,body{width:100%;background:#fff;overflow-x:hidden;overflow-y:auto;margin:0px;height:100%;z-index:0;font-size:12px}\\n` +\r\n    css.replaceAll(\r\n      /https:\\/\\/assets.codepen.io\\/\\d{1,12}\\//g,\r\n      `${resourceLink}/`\r\n    );\r\n  let htmlCode = html.replaceAll(\r\n    /https:\\/\\/assets.codepen.io\\/\\d{1,12}\\//g,\r\n    `${resourceLink}/`\r\n  );\r\n  let jsCode = javascript;\r\n  // pollyfill for multiple dirs file\r\n  for (var link of assetList) {\r\n    styleCode = styleCode.replace(\r\n      link.includes(\"assets.codepen\")\r\n        ? `${resourceLink}/${[...link.split(\"/\")]\r\n            .slice(-(link.split(\"/\").length - 2))\r\n            .join(\"/\")}`\r\n        : `https://${link}`,\r\n      `${resourceLink}/${link.split(\"/\")[link.split(\"/\").length - 1]}`\r\n    );\r\n    htmlCode = htmlCode.replace(\r\n      link.includes(\"assets.codepen\")\r\n        ? `${resourceLink}/${[...link.split(\"/\")]\r\n            .slice(-(link.split(\"/\").length - 2))\r\n            .join(\"/\")}`\r\n        : `https://${link}`,\r\n      `${resourceLink}/${link.split(\"/\")[link.split(\"/\").length - 1]}`\r\n    );\r\n    afterTransCode = afterTransCode.replace(\r\n      link.includes(\"assets.codepen\")\r\n        ? `${resourceLink}/${[...link.split(\"/\")]\r\n            .slice(-(link.split(\"/\").length - 2))\r\n            .join(\"/\")}`\r\n        : `https://${link}`,\r\n      `${resourceLink}/${link.split(\"/\")[link.split(\"/\").length - 1]}`\r\n    );\r\n  }\r\n  // init style dom\r\n  const style = document.createElement(\"style\");\r\n  style.setAttribute(\"type\", \"text/css\");\r\n  style.innerHTML = styleCode;\r\n  // html\r\n  const htmlDom = document.createElement(\"html\");\r\n\r\n  const bodyDom = document.createElement(\"body\");\r\n\r\n  htmlDom.appendChild(style);\r\n  bodyDom.innerHTML = htmlCode;\r\n  // script dom\r\n  const jscontent = document.createElement(\"script\");\r\n  jscontent.setAttribute(\"type\", \"module\");\r\n  // prepare to handle some specifics\r\n  let js = `${jsCode}`.replaceAll(\r\n    /https:\\/\\/assets.codepen.io\\/\\d{1,12}\\//g,\r\n    `${resourceLink}/`\r\n  );\r\n  jscontent.innerHTML = js;\r\n  bodyDom.appendChild(jscontent);\r\n  // 最外层为html\r\n  htmlDom.appendChild(bodyDom);\r\n  const { width = \"100%\", height = \"100%\", target = null } = options;\r\n  //iframe dom\r\n  let curFrame = document.createElement(\"iframe\");\r\n  curFrame.setAttribute(\"width\", width);\r\n  curFrame.setAttribute(\"height\", height);\r\n  curFrame.setAttribute(\"style\", \"border:0px\");\r\n  curFrame.setAttribute(\"srcdoc\", `<!DOCTYPE html>${htmlDom.innerHTML}`);\r\n  target && document.querySelector(target).appendChild(curFrame);\r\n};\r\nexport { renderFrameDom };\r\n"],"names":[],"mappings":"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"}